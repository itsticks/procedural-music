<html>
<head><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" /></head>
<body>
<button>Start Music</button>

<code>
document.getElementById('startMusicBtn').addEventListener('click', initAndPlayMusic);
document.getElementById('startMusicBtn').addEventListener('touchend', initAndPlayMusic); 
  
  let audioContext;
let gainNode;
const chords = {
    CMajor: {
        C: 261.63,
        MicrotonalE: (329.63 + 311.13) / 2,
        G: 392.00
    },
    DMajor: {
        D: 293.66,
        MicrotonalFSharp: (369.99 + 349.23) / 2,
        A: 440.00
    }
};
const oscillatorTypes = ['triangle', 'sawtooth', 'sine'];
let currentChord = 'CMajor';

function initAndPlayMusic() {
    if (!audioContext) {
        audioContext = new AudioContext();
        gainNode = audioContext.createGain();
        gainNode.gain.value = 0.3;
        gainNode.connect(audioContext.destination);
    }

    if (audioContext.state === 'suspended') {
        audioContext.resume();
    }

    playKick();
    playSnare();
    playChord();
}

function playKick() {
    const kickOsc = audioContext.createOscillator();
    const kickGain = audioContext.createGain();

    kickOsc.type = 'sine';
    kickOsc.connect(kickGain);
    kickGain.connect(audioContext.destination);

    kickOsc.frequency.setValueAtTime(150, audioContext.currentTime);
    kickOsc.frequency.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
    kickGain.gain.setValueAtTime(2.5, audioContext.currentTime);
    kickGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

    kickOsc.start(audioContext.currentTime);
    kickOsc.stop(audioContext.currentTime + 0.5);

    setTimeout(playKick, 500);
}

function playSnare() {
    const snareNode = audioContext.createBufferSource();
    const snareGain = audioContext.createGain();
    const snareBuffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.2, audioContext.sampleRate);

    let data = snareBuffer.getChannelData(0);
    for (let i = 0; i < data.length; i++) {
        data[i] = Math.random() * 2 - 1;
    }

    snareNode.buffer = snareBuffer;
    snareNode.connect(snareGain);
    snareGain.connect(audioContext.destination);

    snareGain.gain.setValueAtTime(1.5, audioContext.currentTime);
    snareGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);

    snareNode.start(audioContext.currentTime);
    snareNode.stop(audioContext.currentTime + 0.2);

    setTimeout(playSnare, 1500);
}

function playChord() {
    for (let note in chords[currentChord]) {
        const oscillator = audioContext.createOscillator();

        oscillator.type = oscillatorTypes[Math.floor(Math.random() * oscillatorTypes.length)];
        oscillator.frequency.setValueAtTime(chords[currentChord][note], audioContext.currentTime);
        oscillator.connect(gainNode);

        const randomStartTime = Math.random();
        oscillator.start(audioContext.currentTime + randomStartTime);

        const randomStopTime = 1 + Math.random() * 2;
        oscillator.stop(audioContext.currentTime + randomStartTime + randomStopTime);
    }

    currentChord = (currentChord === 'CMajor') ? 'DMajor' : 'CMajor';
    setTimeout(playChord, 3000);
}

</code>

  <script>
    document.getElementById('startMusicBtn').addEventListener('click', initAndPlayMusic);
document.getElementById('startMusicBtn').addEventListener('touchend', initAndPlayMusic); 
   let audioContext;
let gainNode;
const chords = {
    CMajor: {
        C: 261.63,
        MicrotonalE: (329.63 + 311.13) / 2,
        G: 392.00
    },
    DMajor: {
        D: 293.66,
        MicrotonalFSharp: (369.99 + 349.23) / 2,
        A: 440.00
    }
};
const oscillatorTypes = ['triangle', 'sawtooth', 'sine'];
let currentChord = 'CMajor';

function initAndPlayMusic() {
    if (!audioContext) {
        audioContext = new AudioContext();
        gainNode = audioContext.createGain();
        gainNode.gain.value = 0.3;
        gainNode.connect(audioContext.destination);
    }

    if (audioContext.state === 'suspended') {
        audioContext.resume();
    }

    playKick();
    playSnare();
    playChord();
}

function playKick() {
    const kickOsc = audioContext.createOscillator();
    const kickGain = audioContext.createGain();

    kickOsc.type = 'sine';
    kickOsc.connect(kickGain);
    kickGain.connect(audioContext.destination);

    kickOsc.frequency.setValueAtTime(150, audioContext.currentTime);
    kickOsc.frequency.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
    kickGain.gain.setValueAtTime(2.5, audioContext.currentTime);
    kickGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

    kickOsc.start(audioContext.currentTime);
    kickOsc.stop(audioContext.currentTime + 0.5);

    setTimeout(playKick, 500);
}

function playSnare() {
    const snareNode = audioContext.createBufferSource();
    const snareGain = audioContext.createGain();
    const snareBuffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.2, audioContext.sampleRate);

    let data = snareBuffer.getChannelData(0);
    for (let i = 0; i < data.length; i++) {
        data[i] = Math.random() * 2 - 1;
    }

    snareNode.buffer = snareBuffer;
    snareNode.connect(snareGain);
    snareGain.connect(audioContext.destination);

    snareGain.gain.setValueAtTime(1.5, audioContext.currentTime);
    snareGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);

    snareNode.start(audioContext.currentTime);
    snareNode.stop(audioContext.currentTime + 0.2);

    setTimeout(playSnare, 1500);
}

function playChord() {
    for (let note in chords[currentChord]) {
        const oscillator = audioContext.createOscillator();

        oscillator.type = oscillatorTypes[Math.floor(Math.random() * oscillatorTypes.length)];
        oscillator.frequency.setValueAtTime(chords[currentChord][note], audioContext.currentTime);
        oscillator.connect(gainNode);

        const randomStartTime = Math.random();
        oscillator.start(audioContext.currentTime + randomStartTime);

        const randomStopTime = 1 + Math.random() * 2;
        oscillator.stop(audioContext.currentTime + randomStartTime + randomStopTime);
    }

    currentChord = (currentChord === 'CMajor') ? 'DMajor' : 'CMajor';
    setTimeout(playChord, 3000);
}

  </script>
</body>
</html>
